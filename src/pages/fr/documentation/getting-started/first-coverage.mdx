# Rapporter la premi√®re couverture

√âtape par √©tape pour vous montrer comment rapporter votre premi√®re couverture.

## Instrumentation de code

L'ing√©nierie et la modularisation du front-end ne peuvent se passer de babel. Si votre projet est de ce type, vous n'avez besoin que d'installer deux plugins babel pour commencer rapidement.
[`babel-plugin-istanbul`](https://github.com/istanbuljs/babel-plugin-istanbul) est un plugin babel maintenu officiellement par istanbul.
[`babel-plugin-canyon`](https://github.com/canyon-project/babel-plugin-canyon) est un plugin babel pour faciliter la configuration des informations de projet par les utilisateurs.

### Installation

```shell copy
npm i babel-plugin-istanbul babel-plugin-canyon -D
```

### Configuration

Configurez dans [babel](https://babeljs.io/docs/config-files#configuration-file-types)
```json
{
  "plugins": [
    "istanbul",
    "canyon"
  ]
}
```

Une fois babel install√© et le projet d√©marr√©, affichez **window.\_\_canyon\_\_** et **window.\_\_coverage\_\_** dans la console. Si c'est comme l'image ci-dessous, f√©licitations, l'instrumentation de code est r√©ussie.

import LocalizedLink from "../../../../components/LocalizedLink";

<Callout emoji="üí°">
  Les variables sous Canyon n'existent pas dans l'environnement de d√©veloppement local. Seul dans l'environnement CI, les variables d'environnement seront d√©tect√©es.

  1. Pour plus de m√©thodes de configuration de <LocalizedLink href={'/documentation/ecosystem/babel-plugin-canyon'}>babel-plugin-canyon</LocalizedLink>.

  2. Pour la signification de chaque variable Canyon, vous pouvez consulter <LocalizedLink href={'/documentation/reference/api'}>la description des variables</LocalizedLink>.
</Callout>

![coverage-canyon-console](/static/documentation/getting-started/first-coverage/coverage-canyon-console.png)



## Configuration des variables d'environnement lors de la construction

Dans l'environnement CI, nous avons besoin de configurer certaines variables d'environnement pour rapporter les donn√©es de couverture.

### Obtenir DSN et REPORTER

- DSN : L'interface de rapport fournie par Canyon, url/coverage/client, o√π url est l'adresse du service back-end de Canyon.
- REPORTER : Le token d'utilisateur, utilis√© pour distinguer diff√©rents utilisateurs. Vous pouvez le consulter sur la page de param√®tres de l'utilisateur.

![setting](/static/documentation/getting-started/first-coverage/setting.png)

### Configuration des variables sur la plateforme CI

![gitlab](/static/documentation/getting-started/first-coverage/gitlab-var-config.png)

import { Callout } from 'nextra/components'

<Callout type="info" emoji="‚ÑπÔ∏è">
  Branch, SHA et Project ID ne n√©cessitent pas de configuration et liront automatiquement les variables d'environnement. Nous avons adapt√© des plateformes CI telles que gitlab pipeline et github action.
  Pour plus de d√©tails, vous pouvez consulter <LocalizedLink href={'/documentation/reference/supported-ci-providers'}>la liste des fournisseurs pris en charge</LocalizedLink>.
</Callout>






## Test et rapport

### Automatisation UI

Les utilisateurs peuvent utiliser n'importe quel cadre de test d'automatisation UI, tels que cypress, playwright, puppeteer, selenium, etc. Il suffit de rapporter les donn√©es de couverture apr√®s la fin du test.

Pour plus de r√©f√©rences, consultez
<LocalizedLink href={'/documentation/end-to-end-testing/playwright'}>Test d'automatisation UI</LocalizedLink>.


### Rapport manuel

Les navigateurs Chrome peuvent utiliser le plugin Chrome [canyon-extension](https://chromewebstore.google.com/detail/canyon-extension/omnpafdjidgpdmlimbangcjjaaodbeof?hl=zh-CN&utm_source=ext_sidebar) pour rapporter manuellement les donn√©es de couverture.

![chrome-crx](/static/documentation/getting-started/first-coverage/chrome-crx.png)

## Consultation des rapports

Canyon fournit des rapports riches, vous pouvez consulter le r√©sum√© et les d√©tails de la couverture.

### R√©sum√©

![report-overview](/static/documentation/getting-started/first-coverage/report-overview.png)

### D√©tails

![report-detail](/static/documentation/getting-started/first-coverage/report-detail.png)
